ftr_match_spine:
  keys: ["home_team", "away_team", "date", "season", "league"]

feature:
  momentum:
    translation:
      - object: general.functions.feature_engineering.utils.transforming.dict_replace
        input_col: full_time_result
        dictionary:
          win: 3
          draw: 1
          loss: 0
        column_name: points_per_game
    horizontal_averages:
      - object: general.functions.feature_engineering.aggregation.create_horizontal_averages
        aggregation_columns:
          - bet365_odds
          - gamebookers_odds
          - interwetten_odds
          - ladbrokes_odds
          - sportingbet_odds
          - williamhill_odds
          - stanleybet_odds
          - sporting_odds
          - betwin_odds
          - stanjames_odds
          - vc_odds
          - bluesquare_odds
          - pinnacle_odds
        column_name: betting_odds_winning
      - object: general.functions.feature_engineering.aggregation.create_horizontal_averages
        aggregation_columns:
          - bet365_draw_odds
          - gamebookers_draw_odds
          - interwetten_draw_odds
          - ladbrokes_draw_odds
          - sportingbet_draw_odds
          - williamhill_draw_odds
          - stanleybet_draw_odds
          - sporting_draw_odds
          - betwin_draw_odds
          - stanjames_draw_odds
          - vc_draw_odds
          - bluesquare_draw_odds
          - pinnacle_draw_odds
        column_name: betting_odds_drawing
      - object: general.functions.feature_engineering.aggregation.create_horizontal_averages
        aggregation_columns:
          - bet365_opponent_odds
          - gamebookers_opponent_odds
          - interwetten_opponent_odds
          - ladbrokes_opponent_odds
          - sportingbet_opponent_odds
          - williamhill_opponent_odds
          - stanleybet_opponent_odds
          - sporting_opponent_odds
          - betwin_opponent_odds
          - stanjames_opponent_odds
          - vc_opponent_odds
          - bluesquare_opponent_odds
          - pinnacle_opponent_odds
        column_name: betting_odds_losing
    window_operations:
      - object: general.functions.feature_engineering.aggregation.create_window_aggregates
        partition_by: ["team"]
        order_by: ["datediff"]
        aggregation_columns:
          - betting_odds_winning
          - betting_odds_drawing
          - betting_odds_losing
          - full_time_goals
          - full_time_opponent_goals
          - points_per_game
        aggregation_type: pyspark.sql.functions.avg
        rows_between: [[-30, -1], [-5, -1]]
        prefix: ftr_window
        suffix: last_games
  past_interaction:
    - object: general_functions.feature_engineering.historic_interaction.create_past_interaction_feature
      partition_by: ["team"]
      order_by: ["datediff"]
      home_team_column: home_team
      away_team_column: away_team
      prefix: past_interaction
      suffix: score

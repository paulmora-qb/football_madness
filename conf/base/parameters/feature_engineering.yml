
feature_engineering:
  momentum_features:
    - function: feature_engineering.core.aggregation.create_window_aggregates
      partition_by: ["team"]
      order_by: ["date"]
      aggregation_columns:
        - full_time_team_goals
        - half_time_team_goals
        - team_shots_target
        - full_time_opponent_goals
        - half_time_opponent_goals
        - opponent_shots_target
      aggregation_type: pyspark.sql.functions.sum
      aggregation_range: [1, 5]
      prefix: sum_of
      suffix: last_games
    - function: feature_engineering.core.aggregation.create_window_aggregates
      partition_by: ["team"]
      order_by: ["date"]
      aggregation_columns:
        - team_yellows
        - team_reds
      aggregation_type: pyspark.sql.functions.sum
      aggregation_range: [1, 1]
      prefix: number_of
      suffix: previous_game
